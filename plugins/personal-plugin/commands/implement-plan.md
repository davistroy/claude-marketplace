---
description: Execute IMPLEMENTATION_PLAN.md using orchestrated subagents with automatic testing, documentation, and git workflow
allowed-tools: Bash(git:*), Bash(gh:*), Task, Skill
---

# Implement Plan Command

Execute an IMPLEMENTATION_PLAN.md file using the Ralph Wiggum orchestration pattern. This command spawns subagents to implement each work item while keeping the main agent's context minimal.

## Overview

This command automates the execution of a phased implementation plan by:

1. Reading the plan and tracking progress
2. Implementing each work item via subagents
3. Running tests and fixing failures
4. Updating documentation (PROGRESS.md, LEARNINGS.md)
5. Committing after each work item
6. Creating and merging a PR when complete

## Prerequisites

Before running this command, ensure:

- **IMPLEMENTATION_PLAN.md** exists in the repository root (generated by `/plan-improvements`)
- You are on a feature branch (not main/master)
- Working directory is clean (no uncommitted changes)
- GitHub CLI (gh) is authenticated

## Execution

This command invokes the Ralph Wiggum loop with an orchestrator prompt:

```
/ralph-wiggum:ralph-loop "<orchestrator-prompt>" --completion-promise "PLANCOMPLETE" --max-iterations 100
```

### Orchestrator Behavior

The orchestrator maintains minimal context by delegating all file reading and implementation to subagents. It only retains:

- Completion status
- Files modified
- Errors encountered

### Workflow Per Work Item

For each incomplete work item in IMPLEMENTATION_PLAN.md:

1. **Implementation Subagent**: Reads the plan and implements the work item
2. **Testing Subagent**: Runs all tests, fixes failures until all pass
3. **Documentation Subagent**: Updates IMPLEMENTATION_PLAN.md, PROGRESS.md, LEARNINGS.md
4. **Main Agent**: Commits and pushes changes

### Finalization

When all work items are complete:

1. Polish all documentation
2. Create PR with title "Implementation Complete"
3. Merge PR and clean up branch

## Instructions

Execute the following skill invocation:

```
/ralph-wiggum:ralph-loop "You are an orchestrator. Your job is to coordinate subagents while keeping your own context window minimal.

## CRITICAL RULES FOR CONTEXT MANAGEMENT
- NEVER read large files directly - always delegate file reading to subagents
- When subagents return, only retain: (1) completion status, (2) files modified, (3) errors encountered
- Do NOT ask subagents to return full file contents - only summaries and status
- Use TodoWrite to track progress instead of holding state in context

## STARTUP (do this ONCE at the beginning)
Spawn a subagent to read IMPLEMENTATION_PLAN.md, PROGRESS.md (if exists), and LEARNINGS.md (if exists).
Ask it to return ONLY:
- The next incomplete work item (phase name, item number, brief description)
- Current progress summary (1-2 sentences)
- Total work items remaining

## MAIN LOOP - For each work item:

### Step 1: IMPLEMENTATION (Subagent A)
Spawn implementation subagent with this prompt:
Read IMPLEMENTATION_PLAN.md. Implement work item: [ITEM_PLACEHOLDER].
- Complete ALL tasks in this work item
- Return: (1) files created/modified, (2) implementation summary (max 3 sentences), (3) DONE or error description

Wait for completion. Record only: files changed, success/failure status.

### Step 2: TESTING (Subagent B)
Spawn testing subagent with this prompt:
Run ALL project tests. If failures occur:
1. Diagnose root cause
2. Fix the issue
3. Re-run ALL tests
4. Repeat until ALL tests pass
When all tests pass, return:
- Test summary (pass count, any issues found)
- For each issue fixed: problem, solution, prevention tip (1 line each)
- ALL_TESTS_PASS confirmation

Wait for ALL_TESTS_PASS. If issues were fixed, note them for LEARNINGS.md update.

### Step 3: DOCUMENTATION UPDATE (Subagent C)
Spawn documentation subagent with this prompt:
Update project tracking files:
1. IMPLEMENTATION_PLAN.md - Mark [WORK_ITEM_PLACEHOLDER] as complete with today's date
2. PROGRESS.md - Append entry: date, work item completed, files changed
3. LEARNINGS.md - Append any testing issues provided: [ISSUES_PLACEHOLDER]
Return: DOCS_UPDATED when complete

### Step 4: COMMIT (Main Agent)
Run: git add -A
Then: git commit with message 'Complete [WORK_ITEM_NAME_PLACEHOLDER]'
Then: git push

### Step 5: NEXT ITERATION
Spawn subagent to check IMPLEMENTATION_PLAN.md:
Is there any incomplete work item? Return ONLY: NEXT: item description OR ALL_COMPLETE

If NEXT: return to Step 1 with new item
If ALL_COMPLETE: proceed to FINALIZATION

## FINALIZATION (only when ALL work items complete)

### Final Step 1: Documentation Polish (Subagent)
Review and update all documentation:
- README.md: ensure accuracy, update any outdated sections
- IMPLEMENTATION_PLAN.md: verify all items marked complete
- PROGRESS.md: add completion summary at end
- LEARNINGS.md: synthesize all entries into a SUMMARY section at the top (max 10 bullet points)
Return: DOCS_FINALIZED

### Final Step 2: PR and Merge (Main Agent)
1. Create PR with title 'Implementation Complete' and body 'All phases implemented and tested'
2. Merge the PR and delete the branch
3. Checkout main and pull

### Final Step 3: Output
Output the completion promise: PLANCOMPLETE" --completion-promise "PLANCOMPLETE" --max-iterations 100
```

## Output Files

This command creates/updates:

| File | Purpose |
|------|---------|
| IMPLEMENTATION_PLAN.md | Marks work items complete with dates |
| PROGRESS.md | Chronological log of completed work |
| LEARNINGS.md | Issues encountered and solutions |

## Error Handling

### Missing IMPLEMENTATION_PLAN.md

If IMPLEMENTATION_PLAN.md does not exist:
```
Error: IMPLEMENTATION_PLAN.md not found in repository root.

Run '/plan-improvements' first to generate an implementation plan.
```

### Test Failures That Cannot Be Fixed

If a test failure cannot be resolved after multiple attempts:
1. The testing subagent will report the specific failure
2. The orchestrator will pause and ask for guidance
3. User can choose to skip, provide context, or abort

### Git/PR Failures

If commit or PR operations fail:
1. The error is reported to the user
2. Manual commands are provided to complete the workflow
3. Local changes are preserved

## Performance

**Typical Duration:**

| Plan Size | Expected Duration |
|-----------|------------------|
| Small (5-10 work items) | 15-30 minutes |
| Medium (10-20 work items) | 30-60 minutes |
| Large (20-40 work items) | 1-2 hours |
| Very Large (40+ work items) | 2+ hours |

**Factors Affecting Performance:**

- Work item complexity
- Test suite size and duration
- Number of test failures to fix
- Documentation update scope

**Signs of Abnormal Behavior:**

- Same work item attempted more than 3 times
- Testing subagent in fix loop for more than 10 iterations
- No progress after 15 minutes

**If the command seems stuck:**

1. Check the current iteration count
2. Look for testing loop messages
3. Consider interrupting and resuming with `/ralph-wiggum:ralph-loop` resume capability
4. Review PROGRESS.md for last successful work item

## Example Usage

```
User: /implement-plan

Claude: Starting implementation plan execution...

[Spawns startup subagent to read plan]

Found 12 work items across 3 phases.
Current progress: 0/12 complete
Starting with Phase 1, Item 1.1: Add input validation to CLI parser

[Spawns implementation subagent]
...
Implementation complete. Files modified: src/cli.ts, src/validators.ts

[Spawns testing subagent]
...
All tests pass (47 passed, 0 failed)

[Spawns documentation subagent]
...
Documentation updated.

[Commits: "Complete Phase 1, Item 1.1: Add input validation to CLI parser"]

Moving to Phase 1, Item 1.2...
...

[After all items complete]

All 12 work items implemented successfully.
Creating PR: "Implementation Complete"
PR merged. Checked out main branch.

PLANCOMPLETE
```

## Related Commands

- `/plan-improvements` - Generate IMPLEMENTATION_PLAN.md
- `/plan-next` - Get recommendation for next action
- `/test-project` - Run comprehensive test workflow
- `/ralph-wiggum:help` - Ralph Wiggum technique documentation
