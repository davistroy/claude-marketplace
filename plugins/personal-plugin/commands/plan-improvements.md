---
description: Analyze codebase and generate prioritized improvement recommendations with phased implementation plan
---

# Plan Improvements Command

Perform a comprehensive analysis of the current codebase to identify improvement opportunities, then generate detailed recommendations and a phased implementation plan.

## Instructions

### Phase 1: Deep Codebase Analysis (Ultrathink)

Thoroughly analyze the entire codebase with extended thinking enabled. Focus on:

#### Usability Assessment
- How intuitive is the current workflow?
- Are there friction points in common operations?
- Is the documentation clear and complete?
- Are error messages helpful and actionable?
- Is configuration straightforward?

#### Output Quality Assessment
- Does the output meet professional standards?
- Are there consistency issues in generated content?
- Could templates or patterns improve output quality?
- Are there edge cases that produce poor results?
- What validation or quality checks are missing?

#### Architecture & Design
- Is the code organized logically?
- Are there opportunities for better abstraction?
- Are patterns applied consistently?
- Are there scalability concerns?
- Is the design extensible for future needs?

#### Developer Experience
- How easy is it to add new features?
- Is the code self-documenting?
- Are conventions clear and enforced?
- Are there testing gaps?

#### Missing Capabilities
- What features would users expect but are missing?
- What integrations would add value?
- What automation opportunities exist?

### Phase 2: Generate RECOMMENDATIONS.md

Create a comprehensive recommendations document with this structure:

```markdown
# Improvement Recommendations

**Generated:** [timestamp]
**Analyzed Project:** [project name/path]

---

## Executive Summary

[2-3 paragraph overview of key findings and highest-impact recommendations]

---

## Recommendation Categories

### Category 1: Usability Improvements

#### U1. [Recommendation Title]

**Priority:** Critical | High | Medium | Low
**Effort:** XS | S | M | L | XL
**Impact:** [Description of benefit]

**Current State:**
[What exists now and why it's problematic]

**Recommendation:**
[Specific, actionable improvement]

**Implementation Notes:**
[Technical considerations, dependencies, risks]

---

### Category 2: Output Quality Enhancements

#### Q1. [Recommendation Title]
...

---

### Category 3: Architectural Improvements

#### A1. [Recommendation Title]
...

---

### Category 4: Developer Experience

#### D1. [Recommendation Title]
...

---

### Category 5: New Capabilities

#### N1. [Recommendation Title]
...

---

## Quick Wins

[List of low-effort, high-impact items that can be done immediately]

---

## Strategic Initiatives

[List of larger changes that require planning]

---

## Not Recommended

[Items considered but rejected, with rationale - prevents revisiting]

---

*Recommendations generated by Claude on [timestamp]*
```

### Phase 3: Generate IMPLEMENTATION_PLAN.md

Transform recommendations into an actionable, phased implementation plan:

```markdown
# Implementation Plan

**Generated:** [timestamp]
**Based On:** RECOMMENDATIONS.md
**Total Phases:** [N]

---

## Plan Overview

[Summary of the implementation strategy and phasing rationale]

### Phase Summary Table

| Phase | Focus Area | Key Deliverables | Est. Tokens | Dependencies |
|-------|------------|------------------|-------------|--------------|
| 1 | [Area] | [Deliverables] | ~X0K | None |
| 2 | [Area] | [Deliverables] | ~X0K | Phase 1 |
| ... | ... | ... | ... | ... |

---

## Phase 1: [Phase Title]

**Estimated Effort:** ~X0,000 tokens (including testing/fixes)
**Dependencies:** [None | List of phases]
**Parallelizable:** [Yes/No - can work items run concurrently]

### Goals
- [Goal 1]
- [Goal 2]

### Work Items

#### 1.1 [Task Title]
**Recommendation Ref:** [U1, A2, etc.]
**Files Affected:** [List of files]
**Description:**
[Detailed task description]

**Acceptance Criteria:**
- [ ] [Criterion 1]
- [ ] [Criterion 2]

#### 1.2 [Task Title]
...

### Phase 1 Testing Requirements
- [Test requirement 1]
- [Test requirement 2]

### Phase 1 Completion Checklist
- [ ] All work items complete
- [ ] Tests passing
- [ ] Documentation updated
- [ ] No regressions introduced

---

## Phase 2: [Phase Title]
...

---

## Parallel Work Opportunities

[Identify which phases or work items can be executed concurrently]

| Work Item A | Can Run With | Notes |
|-------------|--------------|-------|
| Phase 1.1 | Phase 1.2 | [Why] |
| ... | ... | ... |

---

## Risk Mitigation

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| [Risk 1] | Low/Med/High | Low/Med/High | [Strategy] |

---

## Success Metrics

[How to measure overall success of the implementation]

---

*Implementation plan generated by Claude on [timestamp]*
```

### Phase Sizing Guidelines

Each phase should:
- Fit within approximately 100,000 tokens of work (including testing and fixes)
- Have clear boundaries and deliverables
- Be independently testable
- Not leave the codebase in a broken state if stopped mid-plan
- Enable parallel work where possible

When estimating phase size:
- Simple file edits: ~1K-5K tokens
- New feature with tests: ~10K-30K tokens
- Refactoring with migration: ~20K-50K tokens
- Complex integration: ~30K-60K tokens
- Reserve ~20% buffer for debugging and fixes

### Phase 4: Save and Report

1. Save RECOMMENDATIONS.md to the repository root
2. Save IMPLEMENTATION_PLAN.md to the repository root
3. Report a summary to the user including:
   - Total recommendations by category and priority
   - Number of phases in the implementation plan
   - Top 3 highest-impact recommendations
   - Suggested starting point

## Execution Guidelines

- **Be thorough**: This analysis informs significant workâ€”miss nothing important
- **Be specific**: Vague recommendations waste time; include file paths, concrete approaches
- **Be realistic**: Estimate effort honestly; overrunning phases causes problems
- **Be practical**: Prioritize impact over elegance; ship value to users
- **Consider context**: Factor in the project's maturity, goals, and constraints
- **Enable parallelism**: Structure phases so multiple streams can work simultaneously when possible
- **Preserve stability**: Each phase should leave the codebase in a working state

## Example Usage

```
User: /plan-improvements

Claude: [Performs deep analysis of the codebase]

I've completed the improvement analysis for claude-marketplace.

**RECOMMENDATIONS.md created** with 23 recommendations across 5 categories:
- Usability: 6 (2 Critical, 2 High, 2 Medium)
- Output Quality: 4 (1 High, 3 Medium)
- Architecture: 5 (1 Critical, 2 High, 2 Medium)
- Developer Experience: 4 (2 High, 2 Low)
- New Capabilities: 4 (1 High, 2 Medium, 1 Low)

**IMPLEMENTATION_PLAN.md created** with 4 phases:
- Phase 1: Foundation (~85K tokens) - Critical fixes and quick wins
- Phase 2: Quality (~75K tokens) - Output improvements
- Phase 3: Architecture (~90K tokens) - Structural refactoring
- Phase 4: Features (~70K tokens) - New capabilities

**Top 3 Highest-Impact Recommendations:**
1. [A1] Standardize command frontmatter validation
2. [U2] Add interactive parameter prompting
3. [Q1] Implement output template system

**Suggested Starting Point:** Phase 1, Item 1.1 - addresses critical stability issue

Files saved:
- RECOMMENDATIONS.md
- IMPLEMENTATION_PLAN.md
```
